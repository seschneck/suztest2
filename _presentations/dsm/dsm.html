<!DOCTYPE html>
<html lang="en"><head>
<script src="dsm_files/libs/clipboard/clipboard.min.js"></script>
<script src="dsm_files/libs/quarto-html/tabby.min.js"></script>
<script src="dsm_files/libs/quarto-html/popper.min.js"></script>
<script src="dsm_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="dsm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dsm_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="dsm_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="dsm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.550">

  <meta name="author" content="John J. Curtin, Ph.D.">
  <title>Smart Digital Therapeutics for Alcohol Use Disorder: Algorithms for Prediction and Adaptive Intervention</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="dsm_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="dsm_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="dsm_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="slides.css">
  <link href="dsm_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="dsm_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="dsm_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="dsm_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="dsm_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="dsm_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="dsm_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="dsm_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="https://github.com/jjcurtin/lectures_science/blob/main/images/smartphone_know_you.png?raw=true" data-background-position="left 10% bottom 10%" data-background-repeat="no" data-background-size="35%" class="quarto-title-block center">
  <h1 class="title">Smart Digital Therapeutics for Alcohol Use Disorder: Algorithms for Prediction and Adaptive Intervention</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
John J. Curtin, Ph.D. 
</div>
        <p class="quarto-title-affiliation">
            University of Wisconsin-Madison
          </p>
    </div>
</div>

</section>
<section id="mental-healthcare-needs-are-high-and-unmet" class="slide level2">
<h2>Mental Healthcare Needs are High and Unmet</h2>
<ul>
<li>In 2019, <span class="red">52 million</span> Americans had an active mental illness
<ul>
<li>More than half did not receive any <span class="red">treatment</span></li>
</ul></li>
</ul>
<aside class="notes">
<p>We have a mental health crisis in the U.S. and it is a crisis of <strong>unmet</strong> high need because our delivery of mental healthcare is deeply flawed.</p>
<p>In 2019, <strong>more than half of the 52 million Americans</strong> with an active mental illness did not receive any treatment. <strong>More than half</strong>!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="mental-healthcare-needs-are-high-and-unmet-1" class="slide level2 smaller">
<h2>Mental Healthcare Needs are High and Unmet</h2>
<ul>
<li><span class="gray">In 2019, 52 million Americans had an active mental illness</span>
<ul>
<li><span class="gray">More than half did not receive any treatment</span></li>
</ul></li>
<li><span class="red">20 million</span> adults had an active substance use disorder
<ul>
<li>9 out of 10 did not receive any treatment</li>
</ul></li>
</ul>
<aside class="notes">
<p>And for the 20 million adults suffering with a substance use disorder, it was worse still.</p>
<p><strong>9 out of 10 without any treatment</strong></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="mental-healthcare-needs-are-high-and-unmet-2" class="slide level2 smaller">
<h2>Mental Healthcare Needs are High and Unmet</h2>
<ul>
<li><span class="gray">In 2019, 52 million Americans had an active mental illness</span>
<ul>
<li><span class="gray">More than half did not receive any treatment</span></li>
</ul></li>
<li><span class="gray">20 million adults had an active substance use disorder</span>
<ul>
<li><span class="gray">9 out of 10 did not receive any treatment</span></li>
</ul></li>
<li>Large treatment disparities exist by race, ethnicity, geography, and income</li>
</ul>
<aside class="notes">
<p>Our failure to treat is even more troubling for vulnerable groups. Black and LatinX adults receive mental healthcare services at only half the rate of whites.</p>
<p>And similar mental healthcare disparities exist for people living in rural communities and for those with lower incomes.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="mental-healthcare-needs-are-high-and-unmet-3" class="slide level2 smaller">
<h2>Mental Healthcare Needs are High and Unmet</h2>
<ul>
<li>Failure to treat is not surprising given many treatment barriers:
<ul>
<li>Access</li>
<li>Availability</li>
<li>Affordability</li>
<li>Acceptability</li>
</ul></li>
</ul>
<aside class="notes">
<p>Our failure to treat is, unfortunately, not surprising. There are many well known barriers to receiving traditional mental healthcare.</p>
<p>These include problems with access that are particularly limiting for people living in rural communities</p>
<p>Problems with availability</p>
<p>Treatment costs are often prohibitive for those without health insurance</p>
<p>and stigma and related issues make traditional treatments for mental illness less acceptable to some patients.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="digital-therapeutics-dtx" class="slide level2">
<h2>Digital Therapeutics (DTx)</h2>
<p>Digital therapeutics are smartphone “apps” that are designed to prevent, manage, or treat disease, including mental illness.</p>
<p>Can augment mental health services to address barriers</p>
<ul>
<li>Accessible everywhere</li>
<li>Available 24/7</li>
<li>Highly scalable (affordable?)</li>
</ul>
<aside class="notes">
<p>Fortunately, digital therapeutics are now being developed and used by patients to address many of these treatment barriers.</p>
<p>For those of you that are not yet familiar with this treatment modality, digital therapeutics are smartphone “apps” that are designed to prevent, manage, or treat disease, including substance use disorders and other mental illness.</p>
<p>These digital therapeutics can be combined with traditional treatments to reduce barriers because they are</p>
<ul>
<li><p>Accessible everywhere</p></li>
<li><p>Available everyday, 24/7</p></li>
<li><p>and highlighly scalable, which may lower costs</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="digital-therapeutics-dtx-1" class="slide level2">
<h2>Digital Therapeutics (DTx)</h2>
<p>Digital therapeutics are smartphone “apps” that are designed to prevent, manage, or treat disease, including mental illness.</p>
<p>Can augment mental health services to address barriers</p>
<ul>
<li><span class="gray">Accessible everywhere</span></li>
<li><span class="gray">Available 24/7</span></li>
<li><span class="gray">Highly scalable (affordable?)</span></li>
<li>Effective!</li>
</ul>
<aside class="notes">
<p>Of course, these benefits would be meaningless if digital therapeutics were not effective.</p>
<p>But they are.</p>
<p>For example, patients with substance use disorders who use a digital therapeutic have almost double the odds of being abstinent from alcohol or other drugs</p>
<p>These increases in abstinence from using digital therapeutics are observed not only when compared to patients on wait lists, who have yet to gain access to treatment but also when digital therapeutics are added on top of traditional treatments for substance use disorders.</p>
<p>And these benefits are durable - they have been documented up to 12 months after the start of treatment.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="beta_app" class="slide level2" data-menu-title="Image of beta app" data-background-image="https://dionysus.psych.wisc.edu/present/meet_faculty/images/beta_app.png" data-background-size="100%" data-background-repeat="none">
<h2></h2>
<aside class="notes">
<p>These apps are in use today with patients with SUD and at least two have recently received FDA approval. However, I think they are still best considered beta versions relative to their full potential.</p>
<p>Their power comes from easy, 24/7 access to their many supports - the treatments, tools, and services built into these smartphone apps. But this is also their Achilles heel. As the patient using these apps, you now have to tackle difficult questions like:</p>
<ul>
<li><p>When should I use them?</p></li>
<li><p>For how long?</p></li>
<li><p>Which of their many supports are best for me?</p></li>
<li><p>And which are best for me <strong>right now</strong>, at this moment in time?</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="smart-digital-therapeutics" class="slide level2">
<h2>Smart Digital Therapeutics</h2>
<blockquote>
<p>“Could you predict not only <span class="red">who</span> might be at greatest risk for relapse … <br> … but precisely <span class="red">when</span> that relapse might occur … <br> … and how <span class="red">best to intervene</span> to prevent it?”</p>
</blockquote>
<aside class="notes">
<p>My research team became interested in these issues when my colleague Dave Gustafson, the developer of a leading digital therapeutic for substance use disorders, approached us with a simple question. He asked…</p>
<p>“Could you predict not only who might be at greatest risk for relapse but precisely when that relapse might occur and how best to intervene to prevent it”</p>
<p>Dave had just completed a large study demonstrating the effectiveness of his app. However, he also noticed many of the people who relapsed hadn’t used the app in the days leading up to that relapse. And others who had relapsed hadn’t used the specific supports in the app that he would have thought would be most effective for them.</p>
<p>The next wave of digital therapeutics, lets call them smart digital therapeutics, must learn to know us well enough to recognize when we are at greatest risk for relapse and they must be smart enough to recommend the specific supports that would be most effective for us at that moment in time to prevent that relapse.</p>
<p>And these apps will do this through the use of built-in artificial intelligence or machine learning algorithms that are powered by personal sensing.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lapse-prediction-in-patients-with-aud" class="slide level2">
<h2>Lapse Prediction in Patients with AUD</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>151 patients with AUD</li>
<li>Early in recovery (1-8 weeks)</li>
<li>Committed to abstinence throughout study</li>
<li>Followed for up to 3 months</li>
<li>Collected active and passive personal sensing data streams</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/risk1_pis.png?raw=true" alt="risk1_pis.png">&nbsp;<br>
<img data-src="https://github.com/jjcurtin/lectures/blob/main/images/niaaa_logo.png?raw=true" alt="niaaa_logo.png">&nbsp;</p>
</div>
</div>
<p><span class="red">GOAL:</span> Develop a temporally precise lapse monitoring (prediction) system for patients with AUD</p>
<aside class="notes">
<p>So let me transition now to describing how we are taking the first baby steps toward developing smart digital therapeutics for SUD</p>
<p>We have recently completed a NIAAA funded project where we collected data from 151 participants who were in early recovery from a moderate to severe alcohol use disorder.</p>
<p>These participants were committed to abstinence at the start of the study and we followed them for up to 3 months, collecting a variety of active and passive personal sensing data streams.</p>
<p>Our first goal with this grant was to develop machine learning algorithms that can generate temporally precise predictions about when future lapses back to alcohol use will occur for patients with AUD.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="personal-sensing-data-streams" class="slide level2">
<h2>Personal Sensing Data Streams</h2>
<ul>
<li><p><span class="red">4X daily ecological momentary assessments (EMA)</span></p></li>
<li><p>Monthly self-report</p></li>
<li><p>Geolocation (GPS)</p></li>
<li><p>Cellular communications (voice and text messages)</p>
<ul>
<li>Meta data</li>
<li>Text message content</li>
</ul></li>
<li><p>Sleep sensor (Wake/sleep times; sleep efficiency; wakings; restlessness)</p></li>
</ul>
<aside class="notes">
<p>As I mentioned, in this project, we collected a variety of active and passive personal sensing data streams.</p>
<p>Participants completed brief (7-10 item) ecological momentary assessments or EMAs, 4 times per day</p>
<p>We also have</p>
<ul>
<li><p>more temporally coarse, monthly self reports,</p></li>
<li><p>Moment by moment geolocation,</p></li>
<li><p>Meta data from their cellular communications and the actual content of their text messages,</p></li>
<li><p>and we had sleep sensors in their beds.</p></li>
</ul>
<p>We are in the early stages of model building at this point and I will focus today on results from preliminary models using only EMA. However, we are actively working with GPS and cellular communications as well and I’ll end with some brief discussion of those preliminary models, as well as early plans on how to implement these models clinically to help patients.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="x-daily-ecological-momentary-assessments" class="slide level2 medium">
<h2>4x Daily Ecological Momentary Assessments</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/risk1_ema_questions.png?raw=true" class="absolute" style="top: 15%; width: 60%; height: auto; " alt="risk1_ema_questions.png">&nbsp;</p>
</div><div class="column" style="width:30%;">
<ul>
<li>Current
<ul>
<li>Craving</li>
<li>Affect</li>
<li>Risky situations</li>
<li>Stressful events</li>
<li>Pleasant events</li>
</ul></li>
<li>Future
<ul>
<li>Risky situations</li>
<li>Stressful events</li>
<li>Confidence</li>
</ul></li>
</ul>
</div>
</div>
<aside class="notes">
<p>So let me tell you a bit more about the 4x daily EMA we collected.</p>
<p>On each EMA, participants reported the date and time of any lapses back to alcohol use that they hadn’t previously reported.</p>
<p>All of the EMAs also asked them about their current craving, affective valence and arousal, recent risky situations, and recent stressful and pleasant events since their last EMA.</p>
<p>On the first EMA each day, they also reported any future risky situations and stressful events that they expected in the next week and their confidence that they would remain abstinent.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="feature-engineering" class="slide level2">
<h2>Feature Engineering</h2>
<ul>
<li><p>Features based on recent past experiences (12, 24, 48, 72, 168 hours)</p></li>
<li><p>Min, max, and median response (all items)</p></li>
<li><p>History (count) of past lapses (item 1) and completed EMAs (compliance)</p></li>
<li><p>Raw scores and change scores (from baseline/all past responses)</p></li>
</ul>
<aside class="notes">
<p>We used these raw EMAs to engineer about 300 features to use in machine learning models to predict future lapses</p>
<p>We formed features by aggregating EMA items over various past time periods ranging from 12 -168 hours in the past</p>
<p>We calculated mins, maxes and medians for the EMA items in these time periods</p>
<p>We also calculated counts of past lapses and counts of past EMAs completed to index engagment with our monitoring system.</p>
<p>And we included these scores both in raw form and as change from baselines for the participant based on all their previous responses since the start of the study.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="machine-learning-methods" class="slide level2">
<h2>Machine Learning Methods</h2>
<ul>
<li><p>Predict hour-by-hour probability of <span class="red">future lapse</span></p></li>
<li><p>Lapse window widths</p>
<ul>
<li>1 hour</li>
<li>1 day</li>
<li>1 week</li>
</ul></li>
</ul>
<aside class="notes">
<p>For our purposes today I wont dive deep into the machine learning methods but let me highlight a few high level details</p>
<p>We used these features I just described to make predictions about the hour-by-hour probability of a future lapse. We are developing separate models for three future lapse windows – lapses in the next hour, lapses in the next day, and lapses in the next week.</p>
<p>For example, if I was in recovery from an AUD, I could use these models to generate the probability that I would lapse after this lecture starting at 1pm. One model would generate the probability of a lapse between 1pm and 2pm today, the second would predict the probability of a lapse between 1pm today and 1pm tomorrow and the third would provide the probability of a lapse anytime between 1pm today and 1pm next Friday</p>
<p>And of course, all of the models would only use data collected prior to 1pm today so that they are “predicting”, in the full sense of the word, into the future and not just demonstrating an association.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="machine-learning-methods-1" class="slide level2 medium">
<h2>Machine Learning Methods</h2>
<ul>
<li>Statistical Algorithms
<ul>
<li>ElasticNet GLM (e.g., LASSO, ridge regression)</li>
<li>Random Forest</li>
<li>XGBoost</li>
<li>KNN</li>
</ul></li>
<li>Model Tuning and Performance Evaluation
<ul>
<li>Area under ROC curve (AUC) as primary performance metric</li>
<li>Sensitivity, Specificity, Balanced accuracy, Positive predictive value</li>
<li>Using <span class="red">grouped</span> (by participant) <span class="red">10-fold CV</span></li>
</ul></li>
</ul>
<aside class="notes">
<p>We are evaluating machine learning model configurations that differ by common statistical algorithms.</p>
<p>We are evaluating these models primarily using the area under the ROC curve but we also consider and report a variety of other common metrics.</p>
<p>And, of course, these performance metrics are calculated for new observations and new participants that the models have never seen and were not trained on by using grouped 10-fold cross-validation.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="week-probabilities-for-no-lapse-and-lapse" class="slide level2">
<h2>1 Week: Probabilities for No Lapse and Lapse</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>Model predicts <span class="red">probability</span> of lapse in next week for “<span class="red">new</span>” observations in test set</p></li>
<li><p>Can panel predictions by <span class="red">Ground Truth</span> (i.e., true lapse vs.&nbsp;no lapse observations</p></li>
<li><p>Want high probabilities to be high for true lapses and low for true no lapses</p></li>
</ul>
</div><div class="column" style="width:40%;">
<!--Lapse Probability by Ground Truth"-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_probability.qmd" data-notebook-title="Risk1 probability plots" data-notebook-cellid="cell-fig-week-no_dec_thres">
<div id="cell-fig-week-no_dec_thres" class="cell" data-fig-height="6" data-fig-width="6">
<div class="cell-output cell-output-display">
<div id="fig-week-no_dec_thres" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-week-no_dec_thres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: P(Lapse | X) by Truth - Week
</figcaption>
<div aria-describedby="fig-week-no_dec_thres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_probability-fig-week-no_dec_thres-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Ok, lets start with the model that provides the coarsest level of temporal specificity – 1 week, and let me take a moment to make the predictions that this machine learning model provides more concrete for you</p>
<p>On the right, you are looking at histograms of the lapse probability predictions that the model makes for all the weeks for all the patients in the held out folds.</p>
<p>I’ve paneled these histograms by whether a lapse did or did not happen in reality for each predicted week. The top panel is for weeks with lapses and the bottom panel is for weeks with no lapses.</p>
<p>Ideally, you want the predicted probabilities to be very high for weeks when there was a lapse and very low for weeks when there was no lapse.</p>
<p>And this is exactly what we see for the one week lapse window model</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="week-probabilities-for-no-lapse-and-lapse-1" class="slide level2">
<h2>1 Week: Probabilities for No Lapse and Lapse</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p><span class="gray">Model predicts probability of lapse in next week for “new” observations in test set</span></p></li>
<li><p><span class="gray">Can panel predictions for GROUND TRUTH lapse and no lapse observations</span></p></li>
<li><p><span class="gray">Want high probabilities to be high for true lapses and low for true no lapses</span></p></li>
<li><p>Need decision threshold for classification [P(Y = Lapse | X) &gt; 0.50 or Youden’s J]</p></li>
</ul>
</div><div class="column" style="width:40%;">
<!--Lapse Probability by Ground Truth-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_probability.qmd" data-notebook-title="Risk1 probability plots" data-notebook-cellid="cell-fig-week">
<div id="cell-fig-week" class="cell" data-fig-height="6" data-fig-width="6">
<div class="cell-output cell-output-display">
<div id="fig-week" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-week-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: P(Lapse | X) by Truth - Day
</figcaption>
<div aria-describedby="fig-week-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_probability-fig-week-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Now to move from probabilities to actual categorical decisions – in other words, predicting a lapse or no lapse in some specific week, we need a decision threshold. A probability of .50 is often used for this threshold, but as we will discuss later, there are times when we might want to choose other thresholds.</p>
<p>But for now, I will use .5 such that the model will predict “lapse” for all weeks with probabilities &gt; .5 and it will predict “no-lapse” for all weeks with probabilities &lt; .5</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="performance-metrics-by-lapse-window-width" class="slide level2">
<h2>Performance Metrics by Lapse Window Width</h2>
<!--TEMP CREATE TABLE IN SLIDE DECK-->
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Performance Metrics by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">auROC</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.89</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">sensitivity</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.82</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">specificity</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.82</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">balanced accuracy</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.83</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<aside class="notes">
<p>Using this decision threshold, we can now calculate the model’s sensitivity, specificity and balanced accuracy which is just the average of these two.</p>
<p>This one week lapse prediction model correctly predicts “lapse” for 79 percent of the weeks that contain a lapse and it correctly predicts “no-lapse” for 85 percent of the weeks that do not include a lapse.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="week-roc-curve" class="slide level2">
<h2>1 Week: ROC Curve</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Area under the ROC curve (AUC)</p>
<ul>
<li><p>Across all decision thresholds</p></li>
<li><p>~.5 (random) – 1.0 (perfect)</p></li>
</ul>
<div class="absolute" style="left: 0%; bottom: 0%; width: 300px; height: auto; ">
<div style="font-size: 75%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Coarse rules of thumb for AUC</strong></p>
</div>
<div class="callout-content">
<p>.70 - .80 are considered fair<br>
.80 - .90 are considered good<br>
&gt; .90 are considered excellent</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<!--ROC Curve for Week-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_roc.qmd" data-notebook-title="EMA ROCs" data-notebook-cellid="cell-fig-roc-week">
<div id="cell-fig-roc-week" class="cell" data-fig-height="6" data-fig-width="6">
<div class="cell-output cell-output-display">
<div id="fig-roc-week" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-roc-week-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: ROC Curves by Model
</figcaption>
<div aria-describedby="fig-roc-week-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_roc-fig-roc-week-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>But as I said, depending on the application, we may not want to always use a .5 decision threshold. And this is where the ROC curve and the area under this curve come into play as a performance metric. The ROC curve is a plot of the model’s sensitivity by its specificity across all possible decision thresholds.</p>
<p>The area under this curve can range from approximately .5 for a random classifier to 1.0 for a classifier that performs perfectly.</p>
<p>And the AUC for our 1 week model is .90, which is generally considered excellent performance.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="day-roc-curve" class="slide level2">
<h2>1 Day: ROC Curve</h2>
<div class="absolute" style="left: 0%; bottom: 0%; width: 300px; height: auto; ">
<div style="font-size: 75%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Coarse rules of thumb for AUC</strong></p>
</div>
<div class="callout-content">
<p>.70 - .80 are considered fair<br>
.80 - .90 are considered good<br>
&gt; .90 are considered excellent</p>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>So we were very encouraged by the performance of this model because it exceeded the performance of the only other published week level lapse prediction model that we were aware of.</p>
<p>But we were also eager to see how well we could do if we required a higher level of temporal precision by developing a day level model.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="day-roc-curve-1" class="slide level2">
<h2>1 Day: ROC Curve</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="absolute" style="left: 0%; bottom: 0%; width: 300px; height: auto; ">
<div style="font-size: 75%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Coarse rules of thumb for AUC</strong></p>
</div>
<div class="callout-content">
<p>.70 - .80 are considered fair<br>
.80 - .90 are considered good<br>
&gt; .90 are considered excellent</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<!--ROC Curve for Week & Day-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_roc.qmd" data-notebook-title="EMA ROCs" data-notebook-cellid="cell-fig-roc-week_day">
<div id="cell-fig-roc-week_day" class="cell" data-fig-height="6" data-fig-width="6">
<div class="cell-output cell-output-display">
<div id="fig-roc-week_day" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-roc-week_day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: ROC Curves by Model
</figcaption>
<div aria-describedby="fig-roc-week_day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_roc-fig-roc-week_day-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>And here is the ROC curve and the AUC for the day level model in green, superimposed on the week level model in orange</p>
<p>The day level model performed as well as, if not better, than the week level model with an AUC of .91</p>
<p>[PAUSE]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="performance-metrics-by-lapse-window-width-1" class="slide level2">
<h2>Performance Metrics by Lapse Window Width</h2>
<!--TEMP CREATE TABLE IN SLIDE DECK-->
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Performance Metrics by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">auROC</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.90</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">sensitivity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.83</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">specificity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.85</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">balanced accuracy</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.83</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<aside class="notes">
<p>And consistent with this higher AUC, the day level model also had slightly better sensitivity and balanced accuracy, along with comparable specificity to the week level model</p>
<p>[PAUSE]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hour-roc-curve" class="slide level2">
<h2>1 Hour: ROC Curve</h2>
<div class="absolute" style="left: 0%; bottom: 0%; width: 300px; height: auto; ">
<div style="font-size: 75%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Coarse rules of thumb for AUC</strong></p>
</div>
<div class="callout-content">
<p>.70 - .80 are considered fair<br>
.80 - .90 are considered good<br>
&gt; .90 are considered excellent</p>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Given our success with this day level model, we next developed a model with the highest level of temporal precision we could build given how we measured lapses, which was the hour level model.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hour-roc-curve-1" class="slide level2">
<h2>1 Hour: ROC Curve</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="absolute" style="left: 0%; bottom: 0%; width: 300px; height: auto; ">
<div style="font-size: 75%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Coarse rules of thumb for AUC</strong></p>
</div>
<div class="callout-content">
<p>.70 - .80 are considered fair<br>
.80 - .90 are considered good<br>
&gt; .90 are considered excellent</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<!--ROC Curve for All-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_roc.qmd" data-notebook-title="EMA ROCs" data-notebook-cellid="cell-fig-roc-all">
<div id="cell-fig-roc-all" class="cell" data-fig-height="6" data-fig-width="6">
<div class="cell-output cell-output-display">
<div id="fig-roc-all" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-roc-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: ROC Curves by Model
</figcaption>
<div aria-describedby="fig-roc-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_roc-fig-roc-all-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>And it turns out that we can do somewhat better still with hour level predictions. Here the blur curve represents the ROC curve for the hour level model, which had the best AUC yet, .93</p>
<p>[PAUSE]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="performance-metrics-by-lapse-window-width-2" class="slide level2">
<h2>Performance Metrics by Lapse Window Width</h2>
<!--TEMP CREATE TABLE IN SLIDE DECK-->
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Performance Metrics by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">auROC</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.93</td>
</tr>
<tr class="even">
<td style="text-align: right;">sensitivity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.86</td>
</tr>
<tr class="odd">
<td style="text-align: right;">specificity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">balanced accuracy</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.85</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<aside class="notes">
<p>And again, consistent with that AUC, the sensitivity, specificity, and balanced accuracy were higher still for this model.</p>
<p>[PAUSE]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="global-feature-importance-by-model" class="slide level2 medium">
<h2>Global Feature Importance by Model</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>All EMA items impact lapse probability (both globally and locally)</li>
</ul>
</div><div class="column" style="width:50%;">
<!--Global SHAP Plot-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_shaps.qmd" data-notebook-title="EMA Study Shaps" data-notebook-cellid="cell-fig-global">
<div id="cell-fig-global" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-global" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-global-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Global SHAPs by Model
</figcaption>
<div aria-describedby="fig-global-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_shaps-fig-global-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>In the spirit of making this model more transparent and interpretable, lets briefly look under the hood at the feature importance</p>
<p>The plot on the right shows feature names and their associated importance indexed by mean absolute SHAP values over all observations. From this we see a few important characteristics of the model.</p>
<p>First, all of EMA items affect predictions about lapse probability globally across observations As you might expect, history of past lapses has a big influence on the probability of a future lapse. But self reported abstinence efficacy, craving, history of stress events and other features from the EMA all make meaningful contributions to lapse probability across observations.</p>
<p>To make these values somewhat meaningful for you, let me remind you these Sh [logodds of .4 = 1.5 odds; logodds of .7 = double the odds]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="local-importance" class="slide level2">
<h2>Local Importance</h2>
<!-- Local SHAP - Hour model-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_shaps.qmd" data-notebook-title="EMA Study Shaps" data-notebook-cellid="cell-fig-local_hour">
<div id="cell-fig-local_hour" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-local_hour" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-local_hour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Local SHAPS - Hour
</figcaption>
<div aria-describedby="fig-local_hour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_shaps-fig-local_hour-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
<!-- Local SHAP - Day model-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_shaps.qmd" data-notebook-title="EMA Study Shaps" data-notebook-cellid="cell-fig-local_day">
<div id="cell-fig-local_day" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-local_day" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-local_day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Local SHAPS - Day
</figcaption>
<div aria-describedby="fig-local_day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_shaps-fig-local_day-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
<!-- Local SHAP - Week model-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_shaps.qmd" data-notebook-title="EMA Study Shaps" data-notebook-cellid="cell-fig-local_week">
<div id="cell-fig-local_week" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-local_week" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-local_week-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Local SHAPS - Week
</figcaption>
<div aria-describedby="fig-local_week-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_shaps-fig-local_week-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="global-variable-importance-by-model" class="slide level2 medium">
<h2>Global Variable Importance by Model</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span class="gray">All EMA items impact lapse probability (both globally and locally)</span></li>
<li>Demographics not particularly important (but limited race/ethnicity diversity)</li>
<li>Lapse day and Lapse hour are useful for day and hour level models as expected</li>
</ul>
</div><div class="column" style="width:50%;">
<!--Global SHAP Plot-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_shaps.qmd" data-notebook-title="EMA Study Shaps" data-notebook-cellid="cell-fig-global">
<div id="cell-fig-global" class="cell">
<div class="cell-output cell-output-display">
<div id="fig-global" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-global-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Global SHAPs by Model
</figcaption>
<div aria-describedby="fig-global-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_shaps-fig-global-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Returning back to the global feature importance plot, we also see that demographics were not particularly important for prediction lapses for these models. However, I’ll return later to acknowledged that we had limited race/ethnicity diversity in the sample. Nonetheless, we had reasonable variability on other participant characteristics like sex, SES, education, and addiction severity.</p>
<p>And finally, we see that we can use lapse day and lapse hour to make predictions with the more temporally precise models. Not surprisingly, people are more likely to lapse on weekends and during evening hours and the associated day and hour level models models can use that information to improve their lapse predictions. These features likely contribute to the superior performance of the hour and to a lesser extent the day model relative to the week interval prediction model.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="positive-predictive-value-ppv" class="slide level2">
<h2>Positive Predictive Value (PPV)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Lapse Rates by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; font-weight: bold; color: red !important;">Lapse Rate</td>
<td style="text-align: center; font-weight: bold; color: red !important;">25.4%</td>
<td style="text-align: center; font-weight: bold; color: red !important;">7.7%</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.4%</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div><div class="column" style="width:50%;">

</div>
</div>
<aside class="notes">
<p>Now, lets return one more time to the performance of these models because I would be remiss if I didn’t complicate the story a bit before we close.</p>
<p>Clearly, the sensitivity, specificity, and balanced accuracy of all three of these models is encouragingly high</p>
<p>But what is often missed when we evaluate the performance of machine learning models is their positive predictive value or PPV. PPV looks at the percentage of positive predictions from the model that are actually true lapses. And PPV is often lower when the positive event, in our case, lapses, is infrequent.</p>
<p>We haven’t talked about the frequency of lapses across the three lapse windows, but it should be intuitively clear that the percent of weeks that contain a lapse will be higher than the percent of days that contain a lapse, and that the percent of hours that contain a lapse will be lower still.</p>
<p>And this is what we see in our data.</p>
<p>But of course, as we increase the decision threshold for labeling a window as a lapse, we will trade off sensitivity. We can see this trade off directly in the precision-recall curves on the right. If we decide we need PPV of at least .75, you can see that we still have reasonable sensitivity for the one week window but we start to miss many lapses in the 1day window and more still in the 1hour window.</p>
<p>I’ll return to this a bit more later when we discuss emerging plans for how best to implement these models within a digital therapeutic.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="positive-predictive-value-ppv-1" class="slide level2">
<h2>Positive Predictive Value (PPV)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Lapse Rates by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; font-weight: bold; color: red !important;">Lapse Rate</td>
<td style="text-align: center; font-weight: bold; color: red !important;">25.4%</td>
<td style="text-align: center; font-weight: bold; color: red !important;">7.7%</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.4%</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Performance Metrics by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">auROC</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center;">0.93</td>
</tr>
<tr class="even">
<td style="text-align: right;">sensitivity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.86</td>
</tr>
<tr class="odd">
<td style="text-align: right;">specificity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">0.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">balanced accuracy</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.85</td>
</tr>
<tr class="odd">
<td style="text-align: right; font-weight: bold; color: red !important;">ppv</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.63</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.30</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.03</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div><div class="column" style="width:50%;">

</div>
</div>
<aside class="notes">
<p>Now, lets return one more time to the performance of these models because I would be remiss if I didn’t complicate the story a bit before we close.</p>
<p>Clearly, the sensitivity, specificity, and balanced accuracy of all three of these models is encouragingly high</p>
<p>But what is often missed when we evaluate the performance of machine learning models is their positive predictive value or PPV. PPV looks at the percentage of positive predictions from the model that are actually true lapses. And PPV is often lower when the positive event, in our case, lapses, is infrequent.</p>
<p>We haven’t talked about the frequency of lapses across the three lapse windows, but it should be intuitively clear that the percent of weeks that contain a lapse will be higher than the percent of days that contain a lapse, and that the percent of hours that contain a lapse will be lower still.</p>
<p>And this is what we see in our data.</p>
<p>But of course, as we increase the decision threshold for labeling a window as a lapse, we will trade off sensitivity. We can see this trade off directly in the precision-recall curves on the right. If we decide we need PPV of at least .75, you can see that we still have reasonable sensitivity for the one week window but we start to miss many lapses in the 1day window and more still in the 1hour window.</p>
<p>I’ll return to this a bit more later when we discuss emerging plans for how best to implement these models within a digital therapeutic.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="positive-predictive-value-ppv-2" class="slide level2">
<h2>Positive Predictive Value (PPV)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Lapse Rates by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right; font-weight: bold; color: red !important;">Lapse Rate</td>
<td style="text-align: center; font-weight: bold; color: red !important;">25.4%</td>
<td style="text-align: center; font-weight: bold; color: red !important;">7.7%</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.4%</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table class="table lightable-classic lightable-striped" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Performance Metrics by Model</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Week</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Day</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">auROC</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.90</td>
<td style="text-align: center;">0.93</td>
</tr>
<tr class="even">
<td style="text-align: right;">sensitivity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.86</td>
</tr>
<tr class="odd">
<td style="text-align: right;">specificity</td>
<td style="text-align: center;">0.82</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">0.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">balanced accuracy</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.85</td>
</tr>
<tr class="odd">
<td style="text-align: right; font-weight: bold; color: red !important;">ppv</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.63</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.30</td>
<td style="text-align: center; font-weight: bold; color: red !important;">0.03</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<!--Precision-Recall Curves by Models-->
<div class="quarto-embed-nb-cell" data-notebook="C:\Users\schneck2\Documents\GitHub\suztest2\notebooks\ema_figs_pr.qmd" data-notebook-title="EMA study PR Curves" data-notebook-cellid="cell-fig-prcurve">
<div id="cell-fig-prcurve" class="cell" data-fig-height="6" data-fig-width="6">
<div class="cell-output cell-output-display">
<div id="fig-prcurve" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-prcurve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: PR Curves by Model
</figcaption>
<div aria-describedby="fig-prcurve-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="dsm_files/figure-revealjs/..-..-notebooks-ema_figs_pr-fig-prcurve-output-1.png">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Now, lets return one more time to the performance of these models because I would be remiss if I didn’t complicate the story a bit before we close.</p>
<p>Clearly, the sensitivity, specificity, and balanced accuracy of all three of these models is encouragingly high</p>
<p>But what is often missed when we evaluate the performance of machine learning models is their positive predictive value or PPV. PPV looks at the percentage of positive predictions from the model that are actually true lapses. And PPV is often lower when the positive event, in our case, lapses, is infrequent.</p>
<p>We haven’t talked about the frequency of lapses across the three lapse windows, but it should be intuitively clear that the percent of weeks that contain a lapse will be higher than the percent of days that contain a lapse, and that the percent of hours that contain a lapse will be lower still.</p>
<p>And this is what we see in our data.</p>
<p>But of course, as we increase the decision threshold for labeling a window as a lapse, we will trade off sensitivity. We can see this trade off directly in the precision-recall curves on the right. If we decide we need PPV of at least .75, you can see that we still have reasonable sensitivity for the one week window but we start to miss many lapses in the 1day window and more still in the 1hour window.</p>
<p>I’ll return to this a bit more later when we discuss emerging plans for how best to implement these models within a digital therapeutic.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="key-take-home-messages" class="slide level2">
<h2>Key Take Home Messages</h2>
<ul>
<li><p>Relatively high combined sensitivity and specificity</p></li>
<li><p>Comparable performance (AUC) from 1 week down to 1 hour windows</p></li>
<li><p>Will need to adjust decision thresholds to fit how we use the algorithm.</p>
<ul>
<li>Lower PPV OK for low burden or low cost recommendations</li>
<li>Higher PPV needed to recommend “costly” interventions or actions</li>
</ul></li>
</ul>
<aside class="notes">
<p>So to recap our main take-aways from this first project</p>
<ul>
<li><p>We were generally encouraged by these preliminary models.</p></li>
<li><p>We’ve demonstrated that we can get relatively high combined sensitivity and specificity</p></li>
<li><p>We can do this for not only coarse one week windows but also temporally precise windows down to one hour</p></li>
<li><p>But we also recognize that depending on what we will use the predictions for, we may need to adjust decision thresholds to trade off sensitivity for greater positive predictive value.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="selective-next-steps" class="slide level2">
<h2>(Selective) Next Steps</h2>
<ul>
<li>Geolocation, cellular communications, and other passively sensed signals</li>
</ul>
<aside class="notes">
<p>One of the key next steps is to develop models that rely more on passive sensing rather than EMA to lower the patient burden of using these systems long term and to gain access to signals that may not be available by self-report.</p>
<p>Let’s take a look at two of the more revealing personal sensing methods that we are developing to provide you with some intuition about how we think this will work.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="gps_detection_1" class="slide level2" data-menu-title="GPS detection, wide view" data-background-image="https://dionysus.psych.wisc.edu/present/meet_faculty/images/john_gps_wide.png" data-background-size="100%" data-background-position="bottom" data-background-repeat="none">
<h2></h2>
<aside class="notes">
<p>Here is a wide view of my moment-by-moment location detected by a GPS app over a month when we were first experimenting with this sensing method. The app recorded the paths that I traveled, with movement by car in green and running in blue.</p>
<p>The red dots indicate places that I stopped to visit for at least a few minutes.</p>
<p>And although not displayed here, the app recorded the days and exact times that I was at each of these locations.</p>
<p>From these data, you can immediately see that I am runner, with long runs leaving from downtown Madison and frequent trail runs on the weekends in the county and state parks to the west and northwest.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="gps_detection_2" class="slide level2" data-menu-title="GPS detection, zoomed" data-background-image="https://dionysus.psych.wisc.edu/present/meet_faculty/images/john_gps_zoom.png" data-background-size="100%" data-background-position="bottom" data-background-repeat="none">
<h2></h2>
<aside class="notes">
<p>Zooming in to the Madison isthmus, these data show that I drove my children halfway around the lake each morning to their elementary school. And from these data we might be able to detect those stressful mornings when getting my young kids dressed and fed didn’t go as planned and we were late, sometimes <strong>very late</strong>, to school!</p>
<p>The app recorded my daily running commute through downtown Madison to and from my office. From this, we can observe my longs days at the office and also those days that I skipped out.</p>
<p>Looking at the red dots indicating the places I visit, the app can detect the restaurants, bars, and coffee shops where I eat, drink and socialize. We can use public map data to identify these places and make inferences about what I do there.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="imagine-my-smartphone-communications" class="slide level2 smaller">
<h2>…Imagine my smartphone communications…</h2>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/smartphone_uber.png?raw=true" class="absolute" style="top: 15%; left: 33%; width: 33%; height: auto; " alt="smartphone_uber.png">&nbsp;</p>
<aside class="notes">
<p>In addition to geolocation, we also collected my smartphone communications logs and even the content of my text messages.</p>
<p>And no such luck, I don’t plan to show you my actual text messages!</p>
<p>But imagine what we could learn about me from the patterns of my communications - Who I was calling, when I made those calls, and even the content of what I sent and received by text message.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="context-is-critical" class="slide level2">
<h2>Context is Critical</h2>
<aside class="notes">
<p>We believe we can improve the predictive strength of these geolocation and communication signals even further by identifying the specific people and places that make us happy or sad or stressed, those that we perceive support our mental health and recovery and those who undermine it.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="context-is-critical-1" class="slide level2">
<h2>Context is Critical</h2>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/smartphone_context.png?raw=true" class="absolute" style="top: 15%; left: 33%; width: 33%; height: auto; " alt="smartphone_context.png">&nbsp;</p>
<aside class="notes">
<p>For example, consider the implications of this brief text message thread between a hypothetical patient and their drinking buddy for what you might predict for the probability that they might lapse back to drinking in the coming hours.</p>
<p>… And how would your prediction change if this wasn’t their drinking buddy but instead, their mom who was a big supporter of their recovery.</p>
<p>This interpersonal context matters!!!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="context-is-critical-2" class="slide level2">
<h2>Context is Critical</h2>
<!--intentional blank page-->
<aside class="notes">
<p>We can gather this contextual information quickly by asking a few key questions about the people and places we interact with frequently over the first couple of months that we record these signals. And we can identify these frequent contacts and locations directly from these signals.</p>
<p>In our current projects, we target people and places that we interact with at least twice a month or more for more detailed follow-up to gather context. And it turns out that this really isn’t that burdensome. Most of us are creatures of habit and if we set a threshold for 2x monthly interactions, we typically only have 10-30 people and places that meet this threshold. And it’s the same people and places each month so we can build this context up when the person first starts to use the system and after that it only needs to be updated occasionally when we go somewhere new or make a new friend.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="contextualized-geolocation" class="slide level2">
<h2>Contextualized Geolocation</h2>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/context_gps.png?raw=true" style="width:75.0%" alt="context_gps.png">&nbsp;</p>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="contextualized-communications" class="slide level2">
<h2>Contextualized Communications</h2>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/context_cell.png?raw=true" style="width:75.0%" alt="context_cell.png">&nbsp;</p>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="baseline-feature-engineering-for-gps" class="slide level2">
<h2>Baseline Feature Engineering for GPS</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Focus on recent past experiences (6, 12, 24, 48, 72, 168 hours)</p></li>
<li><p>Raw scores and change scores (from baseline)</p></li>
<li><p>Time spent at important places (e.g, alcohol present, drank at location in past, risky, unpleasant)</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/feature_gps.png?raw=true" alt="feature_gps.png">&nbsp;</p>
</div>
</div>
<aside class="notes">
<p>To be clear, we have only just begun to train models using GPS. We have started by focusing on recent locations….. DESCRIBE MORE</p>
<p>There is clearly predictive signal in the geolocation signal but not enough to stand alone as the only features at this point. We are seeing AUCs in the low .7s when we use only geolocation to predict future lapses.</p>
<p>However, when we add GPS to the EMA models that I described today, we appear to need fewer unique EMA items to get the same level of model performance. So the addition of GPS may serve to lower patient burden while maintaining model performance.</p>
<p>[PAUSE]</p>
<p>The story is pretty much the same right now for cellular communications as well. At this point we have only worked with the meta data – the contact numbers, call times, durations, etc – combined with context. We haven’t yet done anything with the text message content. And models built from the meta data perform about as well at these preliminary GPS models.</p>
<p>But we are hoping to extract more signal from the both of these as we continue to work on feature engineering with it.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="selective-next-steps-1" class="slide level2">
<h2>(Selective) Next Steps</h2>
<ul>
<li><p><span class="gray">Geolocation, cellular communications, and other passively sensed signals</span></p></li>
<li><p>Build models with lead times &gt; 0 hours</p></li>
</ul>
<aside class="notes">
<p>NEED TEXT FOR THIS BUT ITS IMPORTANT. FOCUS ON lead = 0 for 1 hour and JIT – distraction, urge surfing but lead = 1 week for contact with therapist, sponsor, supportive friends and family, etc.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="selective-next-steps-2" class="slide level2">
<h2>(Selective) Next Steps</h2>
<ul>
<li><p><span class="gray">Geolocation, cellular communications, and other passively sensed signals</span></p></li>
<li><p><span class="gray">Build models with lead times &gt; 0 hours</span></p></li>
<li><p>More diversity in training data</p></li>
</ul>
<aside class="notes">
<p>We are excited by the early performance of these machine learning models BUT I want to be clear that these are preliminary research studies. And they included mostly white participants from our local community in Madison, WI.</p>
<p>Models trained on these participants would be unlikely to work well with black and brown patients or patients from rural communities.</p>
<p>Machine learning models must be trained on diverse samples of patients or their use may exacerbate rather than reduce existing mental healthcare disparities.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="active-project-lapse-in-patients-with-opioid-use-disorder" class="slide level2">
<h2>Active Project: Lapse in patients with Opioid Use Disorder</h2>
<div class="medium">
<ul>
<li>Recruiting 400 patients in recovery from Opioid Use Disorder (All enrolled, many completed )</li>
<li>National sample (size; diversity: demographics, location)</li>
<li>More variation in stage of recover (1 – 6 months at start)</li>
<li>12 months of monitoring</li>
<li>Closer to real implementation methods</li>
</ul>
</div>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/risk2_pis.png?raw=true" alt="risk2_pis.png">&nbsp;</p>
</div><div class="column" style="width:40%;">
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/nida_logo.png?raw=true" alt="nida_logo.png">&nbsp;</p>
</div>
</div>
<aside class="notes">
<p>We are now collecting data for a NIDA funded project where we are specifically recruiting for racial, ethnic, and geographic diversity across the entire United States.</p>
<p>We are also recruiting for people at different stages in their recovery and following them for a longer period of time – up to 12 months</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="selective-next-steps-3" class="slide level2">
<h2>(Selective) Next Steps</h2>
<ul>
<li><p><span class="gray">Geolocation, cellular communications, and other passively sensed signals</span></p></li>
<li><p><span class="gray">Build models with lead times &gt; 0 hours</span></p></li>
<li><p><span class="gray">More diversity in training data</span></p></li>
<li><p>Use models to improve DTx engagement and clinical outcomes</p>
<ul>
<li>SMART DTx – algorithm guided use</li>
<li>How to craft patient feedback to encourage trust in the algorithm</li>
</ul></li>
</ul>
<aside class="notes">
<p>Of course, accurately predicting future lapses is only useful if these predictions can be used to sustain engagement with treatments and improve clinical outcomes.</p>
<p>We have now started to consider how we can use these predictions to help patients optimize their use of a digital therapeutic.</p>
<p>These models may be able to suggest when more use of the DTx is needed because lapse risk is increasing or high but we are also hoping that we can use the models to recommend which tools and supports in the DTx are best for that patient at that moment in time given their lapse risk probability and important features contributing to the lapse prediction.</p>
<p>We are also sensitive to the fact that these recommendations from the machine learning models will need to be provided to patients in a transparent manner that also encourages them to trust the algorithm and follow its recommendations.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="relapse-prevention-model" class="slide level2">
<h2>Relapse Prevention Model</h2>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/relapse_prevention_flowchart.png?raw=true" alt="relapse_prevention_flowchart.png">&nbsp;</p>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="optimization-of-an-algorithm-guided-smart-dtx" class="slide level2 medium">
<h2>Optimization of an Algorithm Guided Smart DTx</h2>
<ul>
<li>Lapse probabilities updated daily based on EMA and Geolocation features</li>
<li>Use lapse probability and locally important features to <span class="red">recommend optimal DTx modules</span> – guided by Relapse Prevention model</li>
<li>Provide recommendations with factorial manipulation of <span class="red">algorithmic transparency</span>
<ul>
<li>risk level</li>
<li>risk change</li>
<li>key important features</li>
</ul></li>
<li>Outcomes
<ul>
<li>Engagement with recommended module</li>
<li>Heavy drinking days</li>
</ul></li>
</ul>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/niaaa_logo.png?raw=true" class="absolute" style="bottom: 5%; right: 2%; width: auto; height: auto; " alt="nida_logo.png">&nbsp;</p>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="data-science-needs" class="slide level2">
<h2>Data Science Needs</h2>
<ul>
<li><p>Pipeline for Daily Module Recommendations</p>
<ul>
<li>Pull sensed data from cloud</li>
<li>Feature engineer sensed data</li>
<li>Generate model lapse probability prediction</li>
<li>Generate local SHAPs</li>
<li>Map all of this to recommendation</li>
<li>Combine with transparancy features</li>
<li>Push up to DTx</li>
</ul></li>
<li><p>Data validity checking and EDA for OUD project</p></li>
<li><p>Develop Sensing App (Apple ResearchKit? Android?)</p></li>
<li><p>Lots of Modeling</p>
<ul>
<li>lag model (Kendra)</li>
<li>gps model (Claire)</li>
<li>communications model (Coco)</li>
<li>AUD screening using social media (Sarah)</li>
</ul></li>
</ul>
</section>
<section id="credits" class="slide level2">
<h2>CRediTs</h2>
<p><img data-src="https://github.com/jjcurtin/lectures/blob/main/images/credits_risk1.png?raw=true" alt="credits.png">&nbsp;</p>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="demographics-alcohol-use-history" class="slide level2">
<h2>Demographics &amp; Alcohol Use History</h2>
<!-- JOHN looks like the latest version of the paper combined these tables - is that okay? -->
<!-- Demographics table-->
</section>
<section id="consort-diagram" class="slide level2">
<h2>Consort Diagram</h2>
<!-- Consort Diagram-->
</section>
<section id="roc-posterior-probabilities" class="slide level2">
<h2>ROC Posterior Probabilities</h2>
<!-- AUC figure by model w/posterior probabilities-->
</section>
<section id="model-comparison-posterior-probabilites" class="slide level2">
<h2>Model Comparison Posterior Probabilites</h2>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="dsm_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="dsm_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="dsm_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="dsm_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>